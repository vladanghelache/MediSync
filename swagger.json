{
  "openapi": "3.1.0",
  "info": {
    "title": "MediSync API",
    "description": "Hospital Management System API for managing doctors, patients, and appointments.",
    "version": "1.0"
  },
  "servers": [
    {
      "url": "http://localhost:8080",
      "description": "Generated server url"
    }
  ],
  "security": [
    {
      "bearerAuth": []
    }
  ],
  "tags": [
    {
      "name": "Doctor Schedules",
      "description": "Management of doctor working hours and recurring weekly shifts."
    },
    {
      "name": "Doctors",
      "description": "Management of doctor profiles and schedule availability."
    },
    {
      "name": "Authentication",
      "description": "Public endpoints for user authentication."
    },
    {
      "name": "Medical Records",
      "description": "Management of diagnosis, prescriptions, and treatment plans. Restricted to Doctors."
    },
    {
      "name": "Allergies",
      "description": "Allergy catalog management. Viewing is authenticated; modification requires ADMIN role."
    },
    {
      "name": "Appointments",
      "description": "Endpoints for booking, viewing, and managing medical appointments."
    },
    {
      "name": "Patients",
      "description": "Patient self-registration, profile management, and medical history access."
    },
    {
      "name": "Users",
      "description": "General user account operations, including password management."
    }
  ],
  "paths": {
    "/doctors/{doctorId}/schedules/{scheduleId}": {
      "get": {
        "tags": [
          "Doctor Schedules"
        ],
        "summary": "Get specific shift details",
        "description": "Retrieves details of a single schedule entry.",
        "operationId": "getSchedule",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "scheduleId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved schedule",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/DoctorScheduleDto"
                }
              }
            }
          },
          "404": {
            "description": "Schedule or Doctor not found"
          }
        }
      },
      "put": {
        "tags": [
          "Doctor Schedules"
        ],
        "summary": "Update working hours",
        "description": "Modifies an existing shift (e.g., changing times). Requires ADMIN role.",
        "operationId": "updateSchedule",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "scheduleId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DoctorScheduleCreateDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Schedule updated successfully",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/DoctorScheduleDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input"
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Schedule not found"
          },
          "409": {
            "description": "Conflict - Overlaps with an existing shift"
          }
        }
      },
      "delete": {
        "tags": [
          "Doctor Schedules"
        ],
        "summary": "Remove working hours",
        "description": "Deletes a working shift from the doctor's schedule. Requires ADMIN role.",
        "operationId": "deleteSchedule",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "scheduleId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Schedule deleted successfully (No Content)"
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Schedule not found"
          }
        }
      }
    },
    "/api/patients/{patientId}/deactivate": {
      "put": {
        "tags": [
          "Patients"
        ],
        "summary": "Deactivate patient",
        "description": "Soft-deletes a patient account. Restricted to Admins.",
        "operationId": "deactivatePatient",
        "parameters": [
          {
            "name": "patientId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Patient successfully deactivated (No Content)"
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Patient not found"
          }
        }
      }
    },
    "/api/patients/{patientId}/activate": {
      "put": {
        "tags": [
          "Patients"
        ],
        "summary": "Activate patient",
        "description": "Restores a deactivated patient account. Restricted to Admins.",
        "operationId": "activatePatient",
        "parameters": [
          {
            "name": "patientId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Patient successfully activated (No Content)"
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Patient not found"
          }
        }
      }
    },
    "/api/patients/{patientId}/": {
      "put": {
        "tags": [
          "Patients"
        ],
        "summary": "Update profile",
        "description": "Allows a patient to update their personal details (address, phone, etc.). Restricted to the account owner.",
        "operationId": "updatePatient",
        "parameters": [
          {
            "name": "patientId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PatientUpdateDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Profile updated successfully",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/PatientDto"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - You can only update your own profile"
          },
          "404": {
            "description": "Patient not found"
          }
        }
      }
    },
    "/api/medical-records/{medicalRecordId}": {
      "put": {
        "tags": [
          "Medical Records"
        ],
        "summary": "Update medical record",
        "description": "Modifies an existing medical record (e.g., updating diagnosis or prescription). Restricted to the assigned Doctor.",
        "operationId": "updateMedicalRecord",
        "parameters": [
          {
            "name": "medicalRecordId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MedicalRecordCreateDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Medical record updated successfully",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/MedicalRecordDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input (e.g., missing diagnosis)"
          },
          "403": {
            "description": "Forbidden - Requires DOCTOR role"
          },
          "404": {
            "description": "Medical record not found"
          }
        }
      },
      "delete": {
        "tags": [
          "Medical Records"
        ],
        "summary": "Delete medical record",
        "description": "Removes a medical record entry. Caution: This action is permanent. Restricted to the assigned Doctor.",
        "operationId": "deleteMedicalRecord",
        "parameters": [
          {
            "name": "medicalRecordId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Medical record deleted successfully (No Content)"
          },
          "403": {
            "description": "Forbidden - Requires DOCTOR role"
          },
          "404": {
            "description": "Medical record not found"
          }
        }
      }
    },
    "/api/doctors/{doctorId}": {
      "get": {
        "tags": [
          "Doctors"
        ],
        "summary": "Get doctor details",
        "description": "Retrieves public profile information for a specific doctor.",
        "operationId": "getDoctorById",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved doctor",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/DoctorDto"
                }
              }
            }
          },
          "404": {
            "description": "Doctor not found"
          }
        }
      },
      "put": {
        "tags": [
          "Doctors"
        ],
        "summary": "Update doctor details",
        "description": "Updates profile information (specialization, etc.). Requires ADMIN role.",
        "operationId": "updateDoctor",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DoctorUpdateDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Doctor updated successfully",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/DoctorDto"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Doctor not found"
          }
        }
      }
    },
    "/api/doctors/{doctorId}/deactivate": {
      "put": {
        "tags": [
          "Doctors"
        ],
        "summary": "Deactivate doctor",
        "description": "Soft-deletes a doctor, preventing new bookings. Requires ADMIN role.",
        "operationId": "deactivateDoctor",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Doctor successfully deactivated (No Content)",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/DoctorDto"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Doctor not found"
          }
        }
      }
    },
    "/api/doctors/{doctorId}/activate": {
      "put": {
        "tags": [
          "Doctors"
        ],
        "summary": "Activate doctor",
        "description": "Restores a deactivated doctor account. Requires ADMIN role.",
        "operationId": "activate",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Doctor successfully activated (No Content)",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/DoctorDto"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Doctor not found"
          }
        }
      }
    },
    "/api/appointments/{appointmentId}/no-show": {
      "put": {
        "tags": [
          "Appointments"
        ],
        "summary": "Mark appointment as No-Show",
        "description": "Marks an appointment as NO_SHOW if the patient did not attend. Requires DOCTOR or ADMIN role.",
        "operationId": "markNoShow",
        "parameters": [
          {
            "name": "appointmentId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Appointment marked as no-show",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/AppointmentDto"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Requires DOCTOR or ADMIN role"
          },
          "404": {
            "description": "Appointment not found"
          },
          "409": {
            "description": "Conflict - Appointment status cannot be changed (e.g., already completed)"
          }
        }
      }
    },
    "/api/appointments/{appointmentId}/cancel": {
      "put": {
        "tags": [
          "Appointments"
        ],
        "summary": "Cancel an appointment",
        "description": "Cancels a scheduled appointment. Access is restricted to the owning Patient, the assigned Doctor, or an Admin.",
        "operationId": "cancelAppointment",
        "parameters": [
          {
            "name": "appointmentId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Appointment successfully cancelled",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/AppointmentDto"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Not authorized to cancel this appointment"
          },
          "404": {
            "description": "Appointment not found"
          },
          "409": {
            "description": "Conflict - Appointment is already completed or cancelled"
          }
        }
      }
    },
    "/api/allergies/{allergyId}": {
      "get": {
        "tags": [
          "Allergies"
        ],
        "summary": "Get allergy by ID",
        "description": "Retrieves details for a specific allergy.",
        "operationId": "getAllergy",
        "parameters": [
          {
            "name": "allergyId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved allergy",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/AllergyDto"
                }
              }
            }
          },
          "404": {
            "description": "Allergy not found"
          }
        }
      },
      "put": {
        "tags": [
          "Allergies"
        ],
        "summary": "Update allergy",
        "description": "Updates details of an existing allergy. Requires ADMIN role.",
        "operationId": "updateAllergy",
        "parameters": [
          {
            "name": "allergyId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AllergyCreateDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Allergy updated successfully",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/AllergyDto"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Allergy not found"
          }
        }
      },
      "delete": {
        "tags": [
          "Allergies"
        ],
        "summary": "Delete allergy",
        "description": "Removes an allergy from the system. Requires ADMIN role.",
        "operationId": "deleteAllergy",
        "parameters": [
          {
            "name": "allergyId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Allergy deleted successfully"
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Allergy not found"
          }
        }
      }
    },
    "/doctors/{doctorId}/schedules": {
      "get": {
        "tags": [
          "Doctor Schedules"
        ],
        "summary": "Get doctor's weekly schedule",
        "description": "Retrieves all defined working shifts (e.g., Mon 09:00-17:00, Wed 10:00-14:00) for a specific doctor.",
        "operationId": "getFullSchedule",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved schedule list",
            "content": {
              "*/*": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/DoctorScheduleDto"
                  }
                }
              }
            }
          },
          "404": {
            "description": "Doctor not found"
          }
        }
      },
      "post": {
        "tags": [
          "Doctor Schedules"
        ],
        "summary": "Add working hours",
        "description": "Creates a new recurring weekly shift for a doctor. Requires ADMIN role.",
        "operationId": "createSchedule",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DoctorScheduleCreateDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Schedule created successfully",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/DoctorScheduleDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input (e.g., Start time after End time)"
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          },
          "404": {
            "description": "Doctor not found"
          },
          "409": {
            "description": "Conflict - Overlaps with an existing shift"
          }
        }
      }
    },
    "/api/patients": {
      "post": {
        "tags": [
          "Patients"
        ],
        "summary": "Register new patient",
        "description": "Public endpoint allows new users to create a patient account. No authentication required.",
        "operationId": "registerPatient",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PatientRegistrationDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Registration successful",
            "content": {
              "*/*": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input (e.g., Email already in use, weak password)"
          }
        },
        "security": []
      }
    },
    "/api/doctors": {
      "get": {
        "tags": [
          "Doctors"
        ],
        "summary": "List all doctors",
        "description": "Retrieves a list of doctors with optional filtering.",
        "operationId": "getDoctors",
        "parameters": [
          {
            "name": "departmentId",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "deactivated",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean",
              "default": false
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved list",
            "content": {
              "*/*": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/DoctorDto"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Doctors"
        ],
        "summary": "Register a new doctor",
        "description": "Creates a new doctor profile and user account. Requires ADMIN role.",
        "operationId": "registerDoctor",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DoctorRegistrationDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Doctor registered successfully",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/DoctorDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input (e.g., email already exists)"
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          }
        }
      }
    },
    "/api/auth/login": {
      "post": {
        "tags": [
          "Authentication"
        ],
        "summary": "User Login",
        "description": "Authenticates a user (Patient, Doctor, or Admin) using email and password. Returns a JWT token if successful.",
        "operationId": "login",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CredentialsDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Authentication successful. JWT token returned.",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/AuthTokenDto"
                }
              }
            }
          }
        },
        "security": []
      }
    },
    "/api/appointments": {
      "post": {
        "tags": [
          "Appointments"
        ],
        "summary": "Book a new appointment",
        "description": "Allows a Patient to schedule an appointment with a doctor. Requires PATIENT role.",
        "operationId": "bookAppointment",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AppointmentBookDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Appointment successfully booked",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/AppointmentDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input (e.g., Doctor not found, invalid time slot)"
          },
          "403": {
            "description": "Forbidden - Only patients can book appointments"
          }
        }
      }
    },
    "/api/appointments/{appointmentId}/complete": {
      "post": {
        "tags": [
          "Appointments"
        ],
        "summary": "Complete an appointment",
        "description": "Marks an appointment as COMPLETED and generates the associated medical record. Requires DOCTOR role.",
        "operationId": "completeAppointment",
        "parameters": [
          {
            "name": "appointmentId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MedicalRecordCreateDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Appointment completed and record created",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/MedicalRecordDto"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Only the assigned doctor can complete this appointment"
          },
          "404": {
            "description": "Appointment not found"
          },
          "409": {
            "description": "Conflict - Appointment is already cancelled or completed"
          }
        }
      }
    },
    "/api/allergies": {
      "get": {
        "tags": [
          "Allergies"
        ],
        "summary": "List all allergies",
        "description": "Retrieves the list of all defined allergies in the system.",
        "operationId": "getAllAllergies",
        "responses": {
          "200": {
            "description": "Successfully retrieved list",
            "content": {
              "*/*": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AllergyDto"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "Allergies"
        ],
        "summary": "Create new allergy",
        "description": "Adds a new allergy to the system. Requires ADMIN role.",
        "operationId": "createAllergy",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AllergyCreateDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Allergy created successfully",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/AllergyDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input (e.g. missing name or duplicate code)"
          },
          "403": {
            "description": "Forbidden - Requires ADMIN role"
          }
        }
      }
    },
    "/api/users/change-password": {
      "patch": {
        "tags": [
          "Users"
        ],
        "summary": "Change password",
        "description": "Updates the password for the currently authenticated user. Requires providing the old password for verification.",
        "operationId": "changePassword",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangePasswordDto"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Password changed successfully"
          },
          "400": {
            "description": "Invalid input (e.g., Old password incorrect"
          },
          "403": {
            "description": "Forbidden - User is not authenticated"
          }
        }
      }
    },
    "/api/users/{userId}": {
      "get": {
        "tags": [
          "Users"
        ],
        "summary": "Get user details",
        "description": "Retrieves basic user information (Role, Email, Status).",
        "operationId": "getUserById",
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved user",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/UserDto"
                }
              }
            }
          },
          "404": {
            "description": "User not found"
          }
        }
      }
    },
    "/api/patients/{patientId}": {
      "get": {
        "tags": [
          "Patients"
        ],
        "summary": "Get patient profile",
        "description": "Retrieves public profile information of a patient.",
        "operationId": "getPatientById",
        "parameters": [
          {
            "name": "patientId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved profile",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/PatientDto"
                }
              }
            }
          },
          "404": {
            "description": "Patient not found"
          }
        }
      }
    },
    "/api/patients/{patientId}/appointments": {
      "get": {
        "tags": [
          "Patients"
        ],
        "summary": "Get patient's appointments",
        "description": "Retrieves the appointment history for a specific patient. Access is restricted to the Patient (owner) or an Admin.",
        "operationId": "getAppointmentsByPatientId",
        "parameters": [
          {
            "name": "patientId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved appointment history",
            "content": {
              "*/*": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppointmentDto"
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Not authorized to view this patient's history"
          },
          "404": {
            "description": "Patient not found"
          }
        }
      }
    },
    "/api/doctors/{doctorId}/appointments": {
      "get": {
        "tags": [
          "Doctors"
        ],
        "summary": "Get doctor's appointments",
        "description": "Retrieves all appointments for a specific doctor. Restricted to the Doctor themselves or Admins.",
        "operationId": "getAppointmentsByDoctorId",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved appointments",
            "content": {
              "*/*": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AppointmentDto"
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Requires DOCTOR or ADMIN role"
          },
          "404": {
            "description": "Doctor not found"
          }
        }
      }
    },
    "/api/doctors/{doctorId}/appointments/slots": {
      "get": {
        "tags": [
          "Doctors"
        ],
        "summary": "Get available time slots",
        "description": "Returns a list of available appointment times for a doctor on a specific date.",
        "operationId": "getAvailableSlots",
        "parameters": [
          {
            "name": "doctorId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "date",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "format": "date"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved slots",
            "content": {
              "*/*": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid date format"
          },
          "404": {
            "description": "Doctor not found"
          }
        }
      }
    },
    "/api/appointments/{appointmentId}": {
      "get": {
        "tags": [
          "Appointments"
        ],
        "summary": "Get appointment details",
        "description": "Retrieves details of a specific appointment. Access is restricted to the owning Patient, the assigned Doctor, or an Admin.",
        "operationId": "getAppointmentById",
        "parameters": [
          {
            "name": "appointmentId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully retrieved appointment details",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/AppointmentDto"
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - User is not associated with this appointment"
          },
          "404": {
            "description": "Appointment not found"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "DoctorScheduleCreateDto": {
        "type": "object",
        "properties": {
          "dayOfWeek": {
            "type": "string",
            "enum": [
              "MONDAY",
              "TUESDAY",
              "WEDNESDAY",
              "THURSDAY",
              "FRIDAY",
              "SATURDAY",
              "SUNDAY"
            ]
          },
          "startTime": {
            "type": "string"
          },
          "endTime": {
            "type": "string"
          },
          "endTimeAfterStartTime": {
            "type": "boolean"
          }
        },
        "required": [
          "dayOfWeek",
          "endTime",
          "startTime"
        ]
      },
      "DoctorScheduleDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64"
          },
          "dayOfWeek": {
            "type": "string",
            "enum": [
              "MONDAY",
              "TUESDAY",
              "WEDNESDAY",
              "THURSDAY",
              "FRIDAY",
              "SATURDAY",
              "SUNDAY"
            ]
          },
          "startTime": {
            "type": "string"
          },
          "endTime": {
            "type": "string"
          },
          "doctorId": {
            "type": "integer",
            "format": "int64"
          },
          "doctorName": {
            "type": "string"
          }
        }
      },
      "PatientUpdateDto": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "minLength": 1
          },
          "lastName": {
            "type": "string",
            "minLength": 1
          },
          "phoneNumber": {
            "type": "string",
            "minLength": 1
          },
          "dateOfBirth": {
            "type": "string",
            "format": "date"
          },
          "gender": {
            "type": "string",
            "enum": [
              "MALE",
              "FEMALE",
              "OTHER"
            ]
          },
          "allergyIds": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int64"
            }
          },
          "address": {
            "type": "string"
          },
          "city": {
            "type": "string"
          },
          "county": {
            "type": "string"
          },
          "country": {
            "type": "string"
          }
        },
        "required": [
          "dateOfBirth",
          "firstName",
          "gender",
          "lastName",
          "phoneNumber"
        ]
      },
      "PatientDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64"
          },
          "firstName": {
            "type": "string"
          },
          "lastName": {
            "type": "string"
          },
          "email": {
            "type": "string"
          },
          "phoneNumber": {
            "type": "string"
          },
          "dateOfBirth": {
            "type": "string",
            "format": "date"
          },
          "gender": {
            "type": "string",
            "enum": [
              "MALE",
              "FEMALE",
              "OTHER"
            ]
          },
          "address": {
            "type": "string"
          },
          "city": {
            "type": "string"
          },
          "county": {
            "type": "string"
          },
          "country": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "MedicalRecordCreateDto": {
        "type": "object",
        "properties": {
          "diagnosis": {
            "type": "string",
            "maxLength": 255,
            "minLength": 0
          },
          "treatmentPlan": {
            "type": "string"
          },
          "prescription": {
            "type": "string"
          }
        },
        "required": [
          "diagnosis"
        ]
      },
      "MedicalRecordDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64"
          },
          "diagnosis": {
            "type": "string"
          },
          "treatmentPlan": {
            "type": "string"
          },
          "prescription": {
            "type": "string"
          },
          "appointmentId": {
            "type": "integer",
            "format": "int64"
          },
          "appointmentTime": {
            "type": "string",
            "format": "date-time"
          },
          "doctorId": {
            "type": "integer",
            "format": "int64"
          },
          "doctorName": {
            "type": "string"
          },
          "patientId": {
            "type": "integer",
            "format": "int64"
          },
          "patientName": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "DoctorUpdateDto": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "minLength": 1
          },
          "lastName": {
            "type": "string",
            "minLength": 1
          },
          "specialization": {
            "type": "string",
            "minLength": 1
          },
          "departmentId": {
            "type": "integer",
            "format": "int64"
          },
          "appointmentDuration": {
            "type": "string"
          }
        },
        "required": [
          "appointmentDuration",
          "departmentId",
          "firstName",
          "lastName",
          "specialization"
        ]
      },
      "DoctorDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64"
          },
          "firstName": {
            "type": "string"
          },
          "lastName": {
            "type": "string"
          },
          "specialization": {
            "type": "string"
          },
          "specializationLabel": {
            "type": "string"
          },
          "departmentId": {
            "type": "integer",
            "format": "int64"
          },
          "departmentName": {
            "type": "string"
          },
          "appointmentDuration": {
            "type": "integer",
            "format": "int32"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "AppointmentDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64"
          },
          "appointmentTime": {
            "type": "string",
            "format": "date-time"
          },
          "reason": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": [
              "SCHEDULED",
              "COMPLETED",
              "CANCELLED",
              "NO_SHOW"
            ]
          },
          "doctor": {
            "$ref": "#/components/schemas/DoctorDto"
          },
          "patient": {
            "$ref": "#/components/schemas/PatientDto"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "medicalRecord": {
            "$ref": "#/components/schemas/MedicalRecordDto"
          }
        }
      },
      "AllergyCreateDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "minLength": 1
          },
          "code": {
            "type": "string",
            "minLength": 1
          },
          "category": {
            "type": "string",
            "minLength": 1
          }
        },
        "required": [
          "category",
          "code",
          "name"
        ]
      },
      "AllergyDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64"
          },
          "name": {
            "type": "string"
          },
          "code": {
            "type": "string"
          },
          "category": {
            "type": "string"
          }
        }
      },
      "PatientRegistrationDto": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "minLength": 1
          },
          "lastName": {
            "type": "string",
            "minLength": 1
          },
          "email": {
            "type": "string",
            "format": "email",
            "minLength": 1
          },
          "password": {
            "type": "string",
            "minLength": 1,
            "pattern": "^(?=.*[0-9])(?=.*[A-Z])(?=.*[!@#$%^&()+=_-])(?=\\S+$).{8,}$"
          },
          "phoneNumber": {
            "type": "string",
            "minLength": 1
          },
          "dateOfBirth": {
            "type": "string",
            "format": "date"
          },
          "gender": {
            "type": "string"
          },
          "allergyIds": {
            "type": "array",
            "items": {
              "type": "integer",
              "format": "int64"
            }
          },
          "address": {
            "type": "string"
          },
          "city": {
            "type": "string"
          },
          "county": {
            "type": "string"
          },
          "country": {
            "type": "string"
          }
        },
        "required": [
          "dateOfBirth",
          "email",
          "firstName",
          "gender",
          "lastName",
          "password",
          "phoneNumber"
        ]
      },
      "DoctorRegistrationDto": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "minLength": 1
          },
          "lastName": {
            "type": "string",
            "minLength": 1
          },
          "email": {
            "type": "string",
            "format": "email",
            "minLength": 1
          },
          "password": {
            "type": "string",
            "minLength": 1
          },
          "specialization": {
            "type": "string",
            "minLength": 1
          },
          "departmentId": {
            "type": "integer",
            "format": "int64"
          },
          "appointmentDuration": {
            "type": "string"
          }
        },
        "required": [
          "appointmentDuration",
          "departmentId",
          "email",
          "firstName",
          "lastName",
          "password",
          "specialization"
        ]
      },
      "CredentialsDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "minLength": 1
          },
          "password": {
            "type": "string",
            "minLength": 1
          }
        },
        "required": [
          "email",
          "password"
        ]
      },
      "AuthTokenDto": {
        "type": "object",
        "properties": {
          "token": {
            "type": "string"
          }
        }
      },
      "AppointmentBookDto": {
        "type": "object",
        "properties": {
          "patientId": {
            "type": "integer",
            "format": "int64"
          },
          "doctorId": {
            "type": "integer",
            "format": "int64"
          },
          "appointmentTime": {
            "type": "string",
            "format": "date-time"
          },
          "reason": {
            "type": "string",
            "minLength": 1
          }
        },
        "required": [
          "appointmentTime",
          "doctorId",
          "patientId",
          "reason"
        ]
      },
      "ChangePasswordDto": {
        "type": "object",
        "properties": {
          "currentPassword": {
            "type": "string",
            "minLength": 1
          },
          "newPassword": {
            "type": "string",
            "minLength": 1,
            "pattern": "^(?=.*[0-9])(?=.*[A-Z])(?=.*[!@#$%^&()+=_-])(?=\\S+$).{8,}$"
          }
        },
        "required": [
          "currentPassword",
          "newPassword"
        ]
      },
      "UserDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "integer",
            "format": "int64"
          },
          "email": {
            "type": "string"
          },
          "role": {
            "type": "string"
          },
          "active": {
            "type": "boolean"
          }
        }
      }
    },
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    }
  }
}